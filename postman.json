{
  "info": {
    "name": "Shipping Module - Unified Providers (Test)",
    "_postman_id": "9b8a3d2f-7c10-4e3a-ae47-2b6d7a0e0001",
    "description": "Unified shipping endpoints. Use provider codes like bosta/dhl/aramex. Includes webhook test.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:8081" },
    { "key": "jwt", "value": "PUT_JWT_HERE" },
    { "key": "provider", "value": "bosta" },
    { "key": "countryId", "value": "1" },
    { "key": "orderId", "value": "123" },
    { "key": "shipmentId", "value": "1" },
    { "key": "webhookAuth", "value": "Basic abc123" }
  ],
  "item": [
    {
      "name": "Meta",
      "item": [
        {
          "name": "List Providers",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{jwt}}", "type": "text" }
            ],
            "url": { "raw": "{{baseUrl}}/shipping/providers", "host": ["{{baseUrl}}"], "path": ["shipping", "providers"] }
          }
        },
        {
          "name": "Unified Statuses",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{jwt}}", "type": "text" }
            ],
            "url": { "raw": "{{baseUrl}}/shipping/statuses", "host": ["{{baseUrl}}"], "path": ["shipping", "statuses"] }
          }
        }
      ]
    },
    {
      "name": "Provider Config",
      "item": [
        {
          "name": "Get Provider Config",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{jwt}}", "type": "text" }
            ],
            "url": {
              "raw": "{{baseUrl}}/shipping/providers/{{provider}}/config",
              "host": ["{{baseUrl}}"],
              "path": ["shipping", "providers", "{{provider}}", "config"]
            }
          }
        },
        {
          "name": "Set Provider Active",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{jwt}}", "type": "text" },
              { "key": "Content-Type", "value": "application/json", "type": "text" }
            ],
            "body": { "mode": "raw", "raw": "{\n  \"isActive\": true\n}" },
            "url": {
              "raw": "{{baseUrl}}/shipping/providers/{{provider}}/active",
              "host": ["{{baseUrl}}"],
              "path": ["shipping", "providers", "{{provider}}", "active"]
            }
          }
        },
        {
          "name": "Set Coverage (supportedAreas)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{jwt}}", "type": "text" },
              { "key": "Content-Type", "value": "application/json", "type": "text" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"supportedAreas\": [\n    \"Cairo\",\n    \"Cairo:Nasr City\",\n    \"Giza\"\n  ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/shipping/providers/{{provider}}/coverage",
              "host": ["{{baseUrl}}"],
              "path": ["shipping", "providers", "{{provider}}", "coverage"]
            }
          }
        },
        {
          "name": "Set Pricing",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{jwt}}", "type": "text" },
              { "key": "Content-Type", "value": "application/json", "type": "text" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"pricing\": {\n    \"currency\": \"EGP\",\n    \"default\": { \"base\": 45, \"perKg\": 10, \"codFee\": 5 },\n    \"byArea\": {\n      \"Cairo\": { \"base\": 50, \"perKg\": 12, \"codFee\": 6 },\n      \"Cairo:Nasr City\": { \"base\": 55, \"perKg\": 12, \"codFee\": 6 }\n    },\n    \"minWeightKg\": 0,\n    \"maxWeightKg\": 50\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/shipping/providers/{{provider}}/pricing",
              "host": ["{{baseUrl}}"],
              "path": ["shipping", "providers", "{{provider}}", "pricing"]
            }
          }
        },
        {
          "name": "Set Limits",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{jwt}}", "type": "text" },
              { "key": "Content-Type", "value": "application/json", "type": "text" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"limits\": {\n    \"maxActiveOrders\": 50,\n    \"maxWeightKg\": 25,\n    \"allowedSizes\": [\"Small\", \"Medium\", \"Large\"]\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/shipping/providers/{{provider}}/limits",
              "host": ["{{baseUrl}}"],
              "path": ["shipping", "providers", "{{provider}}", "limits"]
            }
          }
        }
      ]
    },
    {
      "name": "Provider Data & Actions",
      "item": [
        {
          "name": "Get Areas/Cities (providerRaw + allowedKeys)",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{jwt}}", "type": "text" }
            ],
            "url": {
              "raw": "{{baseUrl}}/shipping/providers/{{provider}}/areas?countryId={{countryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["shipping", "providers", "{{provider}}", "areas"],
              "query": [{ "key": "countryId", "value": "{{countryId}}" }]
            }
          }
        },
        {
          "name": "Quote (price by place)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{jwt}}", "type": "text" },
              { "key": "Content-Type", "value": "application/json", "type": "text" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"city\": \"Cairo\",\n  \"area\": \"Nasr City\",\n  \"weightKg\": 2,\n  \"codAmount\": 0\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/shipping/providers/{{provider}}/quote",
              "host": ["{{baseUrl}}"],
              "path": ["shipping", "providers", "{{provider}}", "quote"]
            }
          }
        },
        {
          "name": "Create Shipment",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{jwt}}", "type": "text" },
              { "key": "Content-Type", "value": "application/json", "type": "text" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"customerName\": \"Test Customer\",\n  \"phoneNumber\": \"01000000000\",\n  \"address\": \"123 Test St\",\n  \"city\": \"Cairo\",\n  \"area\": \"Nasr City\",\n  \"codAmount\": 0,\n  \"notes\": \"test\",\n  \"weightKg\": 1,\n  \"size\": \"Small\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/shipping/providers/{{provider}}/shipments/create",
              "host": ["{{baseUrl}}"],
              "path": ["shipping", "providers", "{{provider}}", "shipments", "create"]
            }
          }
        },
        {
          "name": "Assign Order -> Provider (creates shipment linked to order)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{jwt}}", "type": "text" },
              { "key": "Content-Type", "value": "application/json", "type": "text" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"customerName\": \"Order Customer\",\n  \"phoneNumber\": \"01000000000\",\n  \"address\": \"123 Test St\",\n  \"city\": \"Cairo\",\n  \"area\": \"Nasr City\",\n  \"codAmount\": 0,\n  \"notes\": \"assign order\",\n  \"weightKg\": 1,\n  \"size\": \"Small\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/shipping/providers/{{provider}}/orders/{{orderId}}/assign",
              "host": ["{{baseUrl}}"],
              "path": ["shipping", "providers", "{{provider}}", "orders", "{{orderId}}", "assign"]
            }
          }
        }
      ]
    },
    {
      "name": "Shipments View",
      "item": [
        {
          "name": "List Shipments",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{jwt}}", "type": "text" }
            ],
            "url": {
              "raw": "{{baseUrl}}/shipping/shipments",
              "host": ["{{baseUrl}}"],
              "path": ["shipping", "shipments"]
            }
          }
        },
        {
          "name": "Get Shipment Details",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{jwt}}", "type": "text" }
            ],
            "url": {
              "raw": "{{baseUrl}}/shipping/shipments/{{shipmentId}}",
              "host": ["{{baseUrl}}"],
              "path": ["shipping", "shipments", "{{shipmentId}}"]
            }
          }
        },
        {
          "name": "Get Shipment Events",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{jwt}}", "type": "text" }
            ],
            "url": {
              "raw": "{{baseUrl}}/shipping/shipments/{{shipmentId}}/events",
              "host": ["{{baseUrl}}"],
              "path": ["shipping", "shipments", "{{shipmentId}}", "events"]
            }
          }
        }
      ]
    },
    {
      "name": "Webhook Tests",
      "item": [
        {
          "name": "Webhook: Bosta (DELIVERED example)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "{{webhookAuth}}", "type": "text" },
              { "key": "Content-Type", "value": "application/json", "type": "text" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"_id\": \"providerShipmentId_example\",\n  \"trackingNumber\": \"TRK123456\",\n  \"state\": 45,\n  \"type\": 10\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/shipping/webhooks/{{provider}}",
              "host": ["{{baseUrl}}"],
              "path": ["shipping", "webhooks", "{{provider}}"]
            }
          }
        },
        {
          "name": "Webhook: Bosta (IN_TRANSIT example)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "{{webhookAuth}}", "type": "text" },
              { "key": "Content-Type", "value": "application/json", "type": "text" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"_id\": \"providerShipmentId_example\",\n  \"trackingNumber\": \"TRK123456\",\n  \"state\": 22,\n  \"type\": 10\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/shipping/webhooks/{{provider}}",
              "host": ["{{baseUrl}}"],
              "path": ["shipping", "webhooks", "{{provider}}"]
            }
          }
        }
      ]
    }
  ]
}
